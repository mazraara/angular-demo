{"ast":null,"code":"import _slicedToArray from \"/Users/gapstars/Documents/Projects/ngrx-12-finished/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createClass from \"/Users/gapstars/Documents/Projects/ngrx-12-finished/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/gapstars/Documents/Projects/ngrx-12-finished/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport { __decorate, __metadata } from \"tslib\";\nimport { Actions, Effect, ofType } from '@ngrx/effects';\nimport { Store } from '@ngrx/store';\nimport { HttpClient } from '@angular/common/http';\nimport { switchMap, map, withLatestFrom } from 'rxjs/operators';\nimport * as RecipesActions from './recipe.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/effects\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ngrx/store\";\nexport var RecipeEffects = /*#__PURE__*/_createClass(function RecipeEffects(actions$, http, store) {\n  var _this = this;\n\n  _classCallCheck(this, RecipeEffects);\n\n  this.actions$ = actions$;\n  this.http = http;\n  this.store = store;\n  this.fetchRecipes = this.actions$.pipe(ofType(RecipesActions.FETCH_RECIPES), switchMap(function () {\n    return _this.http.get('https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json');\n  }), map(function (recipes) {\n    return recipes.map(function (recipe) {\n      return Object.assign(Object.assign({}, recipe), {\n        ingredients: recipe.ingredients ? recipe.ingredients : []\n      });\n    });\n  }), map(function (recipes) {\n    return new RecipesActions.SetRecipes(recipes);\n  }));\n  this.storeRecipes = this.actions$.pipe(ofType(RecipesActions.STORE_RECIPES), withLatestFrom(this.store.select('recipes')), switchMap(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        actionData = _ref2[0],\n        recipesState = _ref2[1];\n\n    return _this.http.put('https://ng-course-recipe-book-65f10.firebaseio.com/recipes.json', recipesState.recipes);\n  }));\n});\n\nRecipeEffects.ɵfac = function RecipeEffects_Factory(t) {\n  return new (t || RecipeEffects)(i0.ɵɵinject(i1.Actions), i0.ɵɵinject(i2.HttpClient), i0.ɵɵinject(i3.Store));\n};\n\nRecipeEffects.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: RecipeEffects,\n  factory: RecipeEffects.ɵfac\n});\n\n__decorate([Effect(), __metadata(\"design:type\", Object)], RecipeEffects.prototype, \"fetchRecipes\", void 0);\n\n__decorate([Effect({\n  dispatch: false\n}), __metadata(\"design:type\", Object)], RecipeEffects.prototype, \"storeRecipes\", void 0);","map":null,"metadata":{},"sourceType":"module"}